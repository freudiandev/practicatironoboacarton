<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Debug Sistemas de Armas</title>
  <style>
    body {
      font-family: monospace;
      padding: 20px;
      background: #222;
      color: #0f0;
    }
    .status {
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #444;
      background: #333;
    }
    .ok { color: #0f0; }
    .error { color: #f00; }
    .warning { color: #fa0; }
  </style>
</head>
<body>
  <h1>ðŸ”§ DiagnÃ³stico de Sistemas de Armas</h1>
  <div id="status"></div>
  
  <script src="bullet-effects.js"></script>
  <script src="weapon-audio.js"></script>
  
  <script>
    const statusDiv = document.getElementById('status');
    
    function addStatus(message, type = 'ok') {
      const div = document.createElement('div');
      div.className = `status ${type}`;
      div.innerHTML = message;
      statusDiv.appendChild(div);
    }
    
    // Verificar carga de sistemas
    addStatus('ðŸ” Verificando carga de sistemas...');
    
    if (typeof BulletEffectsSystem !== 'undefined') {
      addStatus('âœ… BulletEffectsSystem cargado correctamente', 'ok');
      
      try {
        const bulletSystem = new BulletEffectsSystem();
        addStatus('âœ… BulletEffectsSystem instanciado', 'ok');
        
        if (typeof bulletSystem.render === 'function') {
          addStatus('âœ… MÃ©todo render disponible', 'ok');
        } else {
          addStatus('âŒ MÃ©todo render NO disponible', 'error');
        }
        
        if (typeof bulletSystem.createBullet === 'function') {
          addStatus('âœ… MÃ©todo createBullet disponible', 'ok');
        } else {
          addStatus('âŒ MÃ©todo createBullet NO disponible', 'error');
        }
        
      } catch (error) {
        addStatus(`âŒ Error al instanciar BulletEffectsSystem: ${error.message}`, 'error');
      }
    } else {
      addStatus('âŒ BulletEffectsSystem NO cargado', 'error');
    }
    
    if (typeof WeaponAudioSystem !== 'undefined') {
      addStatus('âœ… WeaponAudioSystem cargado correctamente', 'ok');
      
      try {
        const audioSystem = new WeaponAudioSystem();
        addStatus('âœ… WeaponAudioSystem instanciado', 'ok');
        
        if (typeof audioSystem.playShotgunSound === 'function') {
          addStatus('âœ… MÃ©todo playShotgunSound disponible', 'ok');
        } else {
          addStatus('âŒ MÃ©todo playShotgunSound NO disponible', 'error');
        }
        
      } catch (error) {
        addStatus(`âŒ Error al instanciar WeaponAudioSystem: ${error.message}`, 'error');
      }
    } else {
      addStatus('âŒ WeaponAudioSystem NO cargado', 'error');
    }
    
    // Verificar en el contexto del juego
    setTimeout(() => {
      addStatus('ðŸŽ® Verificando contexto del juego...');
      
      if (window.DoomGame) {
        addStatus('âœ… DoomGame existe', 'ok');
        
        if (window.DoomGame.bulletEffects) {
          addStatus('âœ… DoomGame.bulletEffects estÃ¡ inicializado', 'ok');
        } else {
          addStatus('âŒ DoomGame.bulletEffects NO estÃ¡ inicializado', 'error');
        }
        
        if (window.DoomGame.weaponAudio) {
          addStatus('âœ… DoomGame.weaponAudio estÃ¡ inicializado', 'ok');
        } else {
          addStatus('âŒ DoomGame.weaponAudio NO estÃ¡ inicializado', 'error');
        }
      } else {
        addStatus('âŒ DoomGame no existe aÃºn', 'warning');
      }
    }, 1000);
    
    // Prueba de disparo
    function testShoot() {
      addStatus('ðŸ”« Ejecutando prueba de disparo...');
      
      if (window.DoomGame && typeof window.DoomGame.shoot === 'function') {
        try {
          window.DoomGame.shoot();
          addStatus('âœ… Disparo ejecutado', 'ok');
        } catch (error) {
          addStatus(`âŒ Error en disparo: ${error.message}`, 'error');
        }
      } else {
        addStatus('âŒ No se puede ejecutar disparo', 'error');
      }
    }
    
    // AÃ±adir botÃ³n de prueba despuÃ©s de 2 segundos
    setTimeout(() => {
      const button = document.createElement('button');
      button.textContent = 'ðŸ”« Probar Disparo';
      button.onclick = testShoot;
      button.style.padding = '10px 20px';
      button.style.fontSize = '16px';
      button.style.margin = '20px 0';
      button.style.background = '#007bff';
      button.style.color = 'white';
      button.style.border = 'none';
      button.style.borderRadius = '5px';
      button.style.cursor = 'pointer';
      statusDiv.appendChild(button);
    }, 2000);
  </script>
</body>
</html>
