<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DOOM: Versión Presidencial - Noboa de Cartón</title>
  
  <!-- Meta tags para SEO y redes sociales -->
  <meta name="description" content="Juego de tiro en primera persona estilo DOOM con Noboa de cartón como protagonista">
  <meta name="keywords" content="juego, doom, fps, tiro, noboa, javascript">
  <meta name="author" content="Samy y Álex">
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="assets/images/favicon.ico">
  <link rel="apple-touch-icon" href="assets/images/apple-touch-icon.png">
  
  <!-- Estilos CSS -->
  <link rel="stylesheet" href="assets/css/game-main.css">

  <!-- 🤖 SISTEMAS DE IA Y MACHINE LEARNING (OPTIMIZADOS PARA RENDIMIENTO) -->
  <!-- DESHABILITADOS TEMPORALMENTE PARA MEJOR RENDIMIENTO -->
  <!-- <script src="assets/js/correctors/CORRECTOR-CRITICO-LEARNING-MEMORY.js"></script> -->
  <!-- <script src="assets/js/ai/learning-memory-advanced.js"></script> -->
  <!-- <script src="assets/js/ai/learning-machine-advanced.js"></script> -->
  <!-- <script src="assets/js/ai/CLASIFICADOR-INTELIGENTE-JS.js"></script> -->
  
</head>

<body>
  <!-- Menú Principal del Juego -->
  <div class="main-menu" id="mainMenu">
    <div class="menu-background">
      <div class="menu-container">
        <div class="game-title">
          <h1>🎯 TIRO CON NOBOA</h1>
          <h2>DE CARTÓN</h2>
          <p class="subtitle">Edición DOOM Presidencial - VERSIÓN LIMPIA</p>
        </div>
        
        <div class="menu-buttons">
          <button class="menu-btn primary" id="startGame">
            <span class="btn-icon">🚀</span>
            <span class="btn-text">INICIAR JUEGO</span>
          </button>
          
          <button class="menu-btn" id="showControls">
            <span class="btn-icon">🎮</span>
            <span class="btn-text">CONTROLES</span>
          </button>
          
          <button class="menu-btn" id="showDonations">
            <span class="btn-icon">💖</span>
            <span class="btn-text">DONACIONES</span>
          </button>
          
          <button class="menu-btn" id="showCredits">
            <span class="btn-icon">👥</span>
            <span class="btn-text">CRÉDITOS</span>
          </button>
        </div>
        
        <div class="menu-footer">
          <p>Desarrollado con ❤️ por <a href="https://www.instagram.com/freudiandev/" target="_blank">freudianDev</a> by <a href="https://cpunkec.6te.net" target="_blank"> CiberPunk EC </a></p>
          <p class="version">Versión Optimizada 0.5.0 - Alto Rendimiento</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Panel de Controles -->
  <div class="info-panel" id="controlsPanel">
    <div class="panel-content">
      <button class="close-btn" id="closeControls">✕</button>
      <h2>🎮 CONTROLES DEL JUEGO</h2>
      <div class="controls-grid">
        <div class="control-section">
          <h3>🚶 Movimiento</h3>
          <div class="control-item">
            <span class="key">W A S D</span>
            <span class="desc">Caminar (adelante, izquierda, atrás, derecha)</span>
          </div>
        </div>
        
        <div class="control-section">
          <h3>👁️ Cámara</h3>
          <div class="control-item">
            <span class="key">🖱️ Mouse</span>
            <span class="desc">Mirar alrededor (requiere clic para bloquear)</span>
          </div>
          <div class="control-item">
            <span class="key">↑ ↓</span>
            <span class="desc">Mirar arriba/abajo (flechas como alternativa)</span>
          </div>
        </div>
        
        <div class="control-section">
          <h3>🔫 Combate Unificado</h3>
          <div class="control-item">
            <span class="key">ESPACIO</span>
            <span class="desc">Disparar (sistema unificado + emergencia)</span>
          </div>
          <div class="control-item">
            <span class="key">🖱️ CLIC</span>
            <span class="desc">Disparar (alternativo con mouse bloqueado)</span>
          </div>
          <div class="control-item">
            <span class="key">ESC</span>
            <span class="desc">Liberar mouse / Menú</span>
          </div>
        </div>
        
        <div class="control-section">
          <h3>🔧 Debugging</h3>
          <div class="control-item">
            <span class="key">F1</span>
            <span class="desc">window.BalasUnificadas.estado()</span>
          </div>
          <div class="control-item">
            <span class="key">F2</span>
            <span class="desc">Sistema de emergencia (respaldo)</span>
          </div>
          <div class="control-item">
            <span class="key">F3</span>
            <span class="desc">window.BalasUnificadas.test()</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Panel de Donaciones -->
  <div class="info-panel" id="donationsPanel">
    <div class="panel-content">
      <button class="close-btn" id="closeDonations">✕</button>
      <h2>💖 APOYA EL PROYECTO</h2>
      <p>Si te gusta este juego, considera hacer una donación para apoyar el desarrollo.</p>
      <div class="donation-buttons">
        <a href="https://paypal.me/yourpaypal" target="_blank" class="donation-btn">
          💳 PayPal
        </a>
        <a href="https://ko-fi.com/yourkofi" target="_blank" class="donation-btn">
          ☕ Ko-fi
        </a>
      </div>
    </div>
  </div>

  <!-- Panel de Créditos -->
  <div class="info-panel" id="creditsPanel">
    <div class="panel-content">
      <button class="close-btn" id="closeCredits">✕</button>
      <h2>👥 CRÉDITOS</h2>
      <div class="credits-section">
        <h3>🎮 Desarrollo</h3>
        <p>freudianDev - Desarrollador Principal</p>
        <p>CiberPunk EC - Equipo de Desarrollo</p>
      </div>
      
      <div class="credits-section">
        <h3>🎨 Arte y Diseño</h3>
        <p>Assets originales de DOOM</p>
        <p>Sprites personalizados de Noboa</p>
      </div>
      
      <div class="credits-section">
        <h3>🔧 Tecnología</h3>
        <p>JavaScript ES6+</p>
        <p>HTML5 Canvas</p>
        <p>CSS3</p>
      </div>
    </div>
  </div>

  <!-- Canvas del Juego -->
  <canvas id="gameCanvas" style="display: none;"></canvas>

  <!-- ========================================= -->
  <!-- SCRIPTS ESENCIALES ÚNICAMENTE -->
  <!-- CORRECTOR DE BUCLES SPAM IMPLEMENTADO -->
  <!-- CORRECTOR CÁMARA VERTICAL IMPLEMENTADO -->
  <!-- ========================================= -->
  
  <!-- 1. MOTOR PRINCIPAL DEL JUEGO -->
  <script src="assets/js/core/DOOM-INTERMEDIO.js"></script>
  <script src="assets/js/physics/WorldPhysics.js"></script>
  
  <!-- ⚡ SISTEMA DE OPTIMIZACIÓN DE RENDIMIENTO (CRÍTICO) -->
  <script src="assets/js/optimization/SISTEMA-OPTIMIZACION-RENDIMIENTO.js"></script>
  
  <script>
    if (window.learningMemory && window.learningMemory.registrarEvento) {
      window.learningMemory.registrarEvento('LOAD_WORLD_PHYSICS', { timestamp: Date.now() });
    }
  </script>
  
  <!-- 2. CORRECTOR MAESTRO UNIFICADO (CONTROLES PRINCIPALES) -->
  <script src="assets/js/correctors/CORRECTOR-MAESTRO-UNIFICADO.js"></script>
  
  <!-- 2.1. CORRECTOR DE BUCLES SPAM (ANTI-BUCLES INFINITOS) -->
  <script src="assets/js/correctors/CORRECTOR-BUCLES-SPAM.js"></script>
  
  <!-- 2.2. CORRECTOR CÁMARA VERTICAL AVANZADO (RAYCASTING COMPLETO) -->
  <script src="assets/js/correctors/CORRECTOR-CAMARA-VERTICAL-AVANZADO.js"></script>
  <script>
    if (window.learningMemory && window.learningMemory.registrarEvento) {
      window.learningMemory.registrarEvento('REACTIVACION_CAMARA_VERTICAL', { timestamp: Date.now() });
    }
  </script>
  
  <!-- 2.3. INICIALIZADOR DE CONTROLES POST-DOOM (CRÍTICO) -->
  <script src="assets/js/correctors/INICIALIZADOR-CONTROLES-POST-DOOM.js"></script>
  
   
  <!-- ⚠️ SISTEMA ÚNICO FINAL - REEMPLAZA TODOS LOS ANTERIORES ⚠️ -->
  <script src="assets/js/correctors/SISTEMA-BALA-UNIFICADO-DEFINITIVO.js"></script>
  
  <!-- 🚨 SISTEMA DE EMERGENCIA TEMPORAL (RESPALDO) -->
  <script src="assets/js/correctors/SISTEMA-EMERGENCIA-DISPARO.js"></script>
  
  <!-- 3. SISTEMA DE COLORES VAPORWAVE (DESHABILITADO PARA RENDIMIENTO) -->
  <!-- <script src="assets/js/systems/SISTEMA-COLORES-VAPORWAVE.js"></script> -->
  
  <!-- 4. SISTEMA DE GRILLA FIJA VAPORWAVE (DESHABILITADO PARA RENDIMIENTO) -->
  <!-- <script src="assets/js/systems/SISTEMA-GRILLA-FIJA-VAPORWAVE.js"></script> -->
  
  <!-- 4.1. SISTEMA DE CÁMARA VERTICAL (DESHABILITADO PARA RENDIMIENTO) -->
  <!-- <script src="assets/js/systems/SISTEMA-CAMARA-VERTICAL.js"></script> -->
  
  <!-- 5. SISTEMA DE CONSTRUCCIÓN DE LABERINTO -->
  <script src="assets/js/systems/CONSTRUCCION-DEFINITIVA-LABERINTO.js"></script>
  
  <!-- 6. SISTEMA DE MENÚ -->
  <script src="assets/js/menu-system.js"></script>
  
  <!-- 7. SISTEMA DE AUDIO -->
  <script src="assets/js/audio.js"></script>
  
  
  <!-- 9. LEARNING MEMORY E IA (OPCIONAL) -->
  <!-- <script src="assets/js/ai/learning-memory-advanced.js"></script> -->
  
  <!-- 10. VALIDADOR FINAL -->
  <script src="assets/js/systems/VALIDADOR-ARCHIVOS.js"></script>
  
  <!-- 11. DIAGNÓSTICO RÁPIDO DE CONTROLES -->
  <script src="assets/js/systems/DIAGNOSTICO-RAPIDO-CONTROLES.js"></script>

  <!-- ========================================= -->
  <!-- SCRIPT DE INICIALIZACIÓN SIMPLIFICADO -->
  <!-- ========================================= -->
  <script>
    console.log('🎮 Inicializando DOOM: Noboa de Cartón - Versión Limpia');
    
    // Configuración de errores mínima
    window.addEventListener('error', (e) => {
      if (!e.filename.includes('404') && !e.message.includes('Failed to load')) {
        console.log('⚠️ Error controlado:', e.message);
      }
    });
    
    // Handler para debugging F1, F2, F3
    document.addEventListener('keydown', (e) => {
      if (e.key === 'F1') {
        e.preventDefault();
        if (window.BalasUnificadas) {
          console.log('🔧 DEBUGGING - Estado del sistema unificado:');
          console.log(window.BalasUnificadas.estado());
        } else {
          console.log('⚠️ Sistema unificado no disponible aún');
        }
      }
      
      if (e.key === 'F3') {
        e.preventDefault();
        if (window.BalasUnificadas && window.BalasUnificadas.test) {
          console.log('🧪 TESTING COMPLETO DEL SISTEMA:');
          const resultado = window.BalasUnificadas.test();
          console.log('📊 Resultado del test:', resultado);
        } else {
          console.log('⚠️ Sistema de testing no disponible');
        }
      }
    });
    
    // Configuración simplificada del menú
    document.addEventListener('DOMContentLoaded', () => {
      console.log('📱 DOM cargado - Configurando interfaz...');
      
      // Configurar botón de inicio
      const startButton = document.getElementById('startGame');
      if (startButton) {
        startButton.addEventListener('click', iniciarJuego);
      }
      
      // Configurar paneles informativos
      configurarPaneles();
      
      console.log('✅ Interfaz configurada correctamente');
    });
    
    // Función para iniciar el juego
    function iniciarJuego() {
      console.log('🚀 Iniciando juego...');
      
      try {
        // Ocultar menú
        const menu = document.getElementById('mainMenu');
        if (menu) menu.style.display = 'none';
        
        // Mostrar canvas
        const canvas = document.getElementById('gameCanvas');
        if (canvas) {
          canvas.style.display = 'block';
          canvas.style.cursor = 'crosshair';
        }
        
        // Inicializar motor DOOM
        if (typeof init === 'function') {
          init();
          console.log('✅ Motor del juego inicializado');
        }
        
        // Iniciar el juego
        if (typeof startGame === 'function') {
          startGame();
          console.log('✅ Juego iniciado');
        }
        
        // Inicializar sistemas avanzados
        setTimeout(() => {
          // Sistema de disparo
          if (window.SistemaDisparo) {
            window.SistemaDisparo.inicializar();
            console.log('✅ Sistema de disparo inicializado');
          }
          
          // Efectos visuales
          if (window.EfectosBala) {
            window.EfectosBala.inicializar();
            console.log('✅ Efectos visuales inicializados');
          }
          
          // Audio 8-bits
          if (window.Audio8Bits) {
            window.Audio8Bits.inicializar();
            console.log('✅ Audio 8-bits inicializado');
          }
          
          // El corrector maestro se encarga de todo lo demás
          console.log('🎮 JUEGO LISTO - El Corrector Maestro maneja todos los controles');
          console.log('🖱️ Haz clic en la pantalla para capturar el mouse');
          console.log('⌨️ Usa WASD para moverte, clic para disparar, ESC para liberar mouse');
          
        }, 500);
        
      } catch (error) {
        console.error('❌ Error al iniciar juego:', error);
        alert('Error al iniciar el juego. Revisa la consola para más detalles.');
      }
    }
    
    // Configurar paneles informativos
    function configurarPaneles() {
      // Panel de controles
      const showControls = document.getElementById('showControls');
      const controlsPanel = document.getElementById('controlsPanel');
      const closeControls = document.getElementById('closeControls');
      
      if (showControls && controlsPanel && closeControls) {
        showControls.addEventListener('click', () => {
          controlsPanel.style.display = 'flex';
        });
        
        closeControls.addEventListener('click', () => {
          controlsPanel.style.display = 'none';
        });
      }
      
      // Panel de donaciones
      const showDonations = document.getElementById('showDonations');
      const donationsPanel = document.getElementById('donationsPanel');
      const closeDonations = document.getElementById('closeDonations');
      
      if (showDonations && donationsPanel && closeDonations) {
        showDonations.addEventListener('click', () => {
          donationsPanel.style.display = 'flex';
        });
        
        closeDonations.addEventListener('click', () => {
          donationsPanel.style.display = 'none';
        });
      }
      
      // Panel de créditos
      const showCredits = document.getElementById('showCredits');
      const creditsPanel = document.getElementById('creditsPanel');
      const closeCredits = document.getElementById('closeCredits');
      
      if (showCredits && creditsPanel && closeCredits) {
        showCredits.addEventListener('click', () => {
          creditsPanel.style.display = 'flex';
        });
        
        closeCredits.addEventListener('click', () => {
          creditsPanel.style.display = 'none';
        });
      }
      
      // Cerrar paneles con clic fuera
      document.addEventListener('click', (e) => {
        const panels = [controlsPanel, donationsPanel, creditsPanel];
        panels.forEach(panel => {
          if (panel && panel.style.display === 'flex' && 
              !panel.contains(e.target) && 
              !e.target.closest('.menu-btn')) {
            panel.style.display = 'none';
          }
        });
      });
    }
    
    console.log('✅ Script de inicialización cargado correctamente');
  </script>

  <!-- Registro en Learning Memory de desactivación de grilla/vaporwave -->
  <script>
    if (window.learningMemory && window.learningMemory.registrarEvento) {
      window.learningMemory.registrarEvento('DESACTIVACION_SISTEMAS_VAPORWAVE', {
        sistemasDesactivados: [
          'SISTEMA-COLORES-VAPORWAVE.js',
          'SISTEMA-GRILLA-FIJA-VAPORWAVE.js',
          'SISTEMA-CAMARA-VERTICAL.js',
          'CORRECTOR-CAMARA-VERTICAL-AVANZADO.js'
        ],
        descripcion: 'Se eliminaron grillas y líneas dinámicas del piso y cámara para corregir error de líneas verticales persistentes en pantalla.'
      });
    }
  </script>
  <!-- FIN registro Learning Memory -->

  <!-- VALIDADOR DE ARCHIVOS POST-REORGANIZACIÓN -->
  <script src="assets/js/systems/VALIDADOR-ARCHIVOS.js"></script>

  <!-- ========================================= -->
  <!-- VALIDADOR POST-CORRECCIÓN (FINAL) -->
  <!-- ========================================= -->
  <script src="assets/js/debug/VALIDADOR-POST-CORRECCION.js"></script>

  <!-- ========================================= -->
  <!-- FIN DE CARGA DE SCRIPTS -->
  <!-- SISTEMA OPTIMIZADO Y VALIDADO -->
  <!-- ========================================= -->
</body>
</html>
