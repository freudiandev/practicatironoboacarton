/* Estilos responsive y controles móviles */
:root {
  --mc-size: clamp(48px, 7.5vw, 76px);
  --mc-gap: clamp(8px, 1.2vw, 16px);
  --mc-font: clamp(14px, 2.2vw, 22px);
}

/* Layout base responsive para el contenedor del juego */
#game-container {
  width: 100%;
  height: auto;
  display: block;
  aspect-ratio: 16 / 9; /* mantener proporción en responsive */
  position: relative;
}

#game-container canvas {
  width: 100% !important;
  height: 100% !important;
  display: block;
}

/* Oculta panel derecho en pantallas estrechas */
@media (max-width: 1024px) {
  .right-panel-improved { display: none !important; }
}

/* === Mobile UX: evitar que el HUD “tape” el juego === */
@media (max-width: 720px) {
  .game-layout-improved {
    grid-template-columns: 1fr !important;
    grid-template-rows: 1fr !important;
    padding: 0 !important;
    gap: 0 !important;
  }

  /* El panel derecho (donaciones) ocupa demasiado en móvil */
  #hud-panel {
    display: none !important;
  }

  /* Convertir el panel izquierdo en una barra compacta superpuesta */
  #hud-panel-left {
    position: fixed !important;
    left: calc(env(safe-area-inset-left, 0px) + 10px) !important;
    right: calc(env(safe-area-inset-right, 0px) + 10px) !important;
    top: calc(env(safe-area-inset-top, 0px) + 10px) !important;
    bottom: auto !important;
    z-index: 9997 !important;
    border-radius: 14px !important;
    padding: 10px 10px !important;
    max-height: none !important;
    overflow: hidden !important;
  }

  /* Mostrar sólo lo esencial (vida + ammo) para liberar pantalla */
  #hud-panel-left .hud-minimap,
  #hud-panel-left .hud-stats {
    display: none !important;
  }

  #hud-panel-left {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 10px !important;
  }

  #hud-panel-left .hud-section {
    max-height: none !important;
    overflow: hidden !important;
    padding: 10px 10px 12px !important;
  }

  #hud-panel-left .section-title {
    font-size: 11px !important;
    letter-spacing: 0.18em !important;
    margin-bottom: 8px !important;
  }

  #hud-panel-left .life-values {
    font-size: 16px !important;
  }

  #hud-panel-left .hud-ammo .info-row {
    font-size: 12px !important;
    padding: 4px 0 !important;
  }

  /* Maximizar el canvas en móvil */
  #game-container {
    grid-column: 1 !important;
    grid-row: 1 !important;
    height: 100vh !important;
    min-height: 100vh !important;
    padding: 0 !important;
    border-radius: 0 !important;
  }

  /* Las bandas superiores/inferiores quitan área útil en pantallas pequeñas */
  #game-container::before,
  #game-container::after {
    display: none !important;
  }

  #gameCanvas {
    width: 100vw !important;
    max-width: 100vw !important;
    max-height: 100vh !important;
    height: auto !important;
    border-radius: 0 !important;
  }

  /* Separar el overlay de controles del HUD superior */
  #mobile-controls {
    padding-top: calc(env(safe-area-inset-top, 0px) + 14px);
    padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 14px);
  }

  #mc-shot.mc-shot {
    bottom: calc(env(safe-area-inset-bottom, 0px) + 14px);
    right: calc(env(safe-area-inset-right, 0px) + 14px);
  }
}

/* Mobile controls overlay */
#mobile-controls {
  position: fixed;
  inset: 0;
  pointer-events: none; /* botones habilitan pointer-events */
  display: grid;
  grid-template-columns: 1fr 1fr;
  align-items: end;
  padding: 2.5vh 2.5vw;
  gap: 2vw;
  z-index: 9998;
}

#mobile-controls.hidden { display: none; }

#mobile-controls .mc-left,
#mobile-controls .mc-right {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--mc-gap);
}

#mobile-controls .mc-row {
  display: flex;
  gap: var(--mc-gap);
}

#mobile-controls .mc-btn {
  pointer-events: auto;
  width: var(--mc-size);
  height: var(--mc-size);
  border-radius: 12px;
  border: 2px solid rgba(255,255,255,0.3);
  background: rgba(0,0,0,0.35);
  color: #fff;
  font-weight: 700;
  font-size: var(--mc-font);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.4);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
}

#mobile-controls .mc-btn:active,
#mobile-controls .mc-btn.is-active {
  transform: scale(0.96);
  background: rgba(0,0,0,0.6);
  border-color: rgba(255,255,255,0.6);
}

#mc-shot.mc-shot {
  position: fixed;
  right: 2.5vw;
  bottom: 2.5vh;
  pointer-events: auto;
  width: calc(var(--mc-size) * 1.5);
  height: calc(var(--mc-size) * 1.5);
  border-radius: 50%;
  border: 2px solid rgba(255,255,255,0.4);
  background: radial-gradient(circle at 30% 30%, rgba(255,0,0,0.85), rgba(180,0,0,0.85));
  color: #fff;
  font-weight: 800;
  font-size: clamp(14px, 2vw, 20px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.55);
}

/* Overlay de rotación */
#rotate-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.9);
  color: #fff;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
}
#rotate-overlay.hidden { display: none; }

#rotate-overlay .rotate-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  padding: 24px 28px;
  border-radius: 14px;
  background: rgba(20,20,20,0.8);
  border: 1px solid rgba(255,255,255,0.15);
}

#rotate-overlay .rotate-icon { font-size: 48px; }
#rotate-overlay .rotate-text { font-size: 18px; opacity: 0.9; }

/* Ajustes por categorías (solo ejemplo principal; escalas ya usan clamp) */
@media (min-width: 1921px) {
  :root { --mc-size: 90px; }
}

@media (max-width: 480px) {
  :root { --mc-size: 56px; }
}
